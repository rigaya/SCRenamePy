# SCRename.py

## 概要
SCRename.pyは、SCRename.vbsのpython移植版で、[しょぼいカレンダー](http://cal.syoboi.jp/)からタイトル・話数・サブタイトル・放送日時を取得し、ファイル名を自動でリネームするツールです。

本ツールはAmatsukazeのLinux対応の一環で、SCRename.vbsのpython移植を試みたものです。主な違いとして、設定ファイル（SCRename.srv, SCRename.rp1, SCRename.rp2, SCRename.exc等）は**UTF-8**で記述してください（オリジナル版はShift_JIS/UTF-16対応でしたが、Python版はUTF-8のみ対応です）。

EpgDataCap_BonやTvRock等の録画ソフトとの連携を想定していますが、ファイル名が規則通りであれば他の用途でも利用可能です。

## 想定動作環境
- Python 3.7以降が動作する環境

## 使い方
コマンドプロンプトまたはバッチファイル等で以下のように実行します。

```
SCRename.py [オプション] "ファイル" "リネーム書式" [番組名開始位置] [検索文字数]
```

### オプション
- `-a`   : 話数検索を有効にします
- `-a1`  : 通常の検索を省略して話数検索のみを行います
- `-f`   : 強制リネームを行います
- `-h,-?`: ヘルプを表示します
- `-n`   : サブタイトルを取得できない場合に処理を中止します
- `-t`   : フォルダ作成およびリネームを行いません（テストモード）
- `-s`   : 不要な空白の削除を行いません

### 引数
- `ファイル` : リネーム対象のファイルへのパス
- `リネーム書式` : リネーム後のファイル名の書式
- `番組名開始位置` : ファイル名の先頭を1として、番組名の開始位置（省略時は自動判定）
- `検索文字数` : 番組名検索に使う文字数（省略時は4）

### リネーム書式の例
- `$SCtitle$` : タイトル
- `$SCpart$` : パート（前編など）
- `$SCnumber$` : 話数（2桁以上）
- `$SCsubtitle$` : サブタイトル
- `$SCservice$` : 放送局名
- `$SCdate$` : 放送開始年月日（YYMMDD）
- `$SCtime$` : 放送開始時刻（hhmm）
- ほか多数（詳細はReadme.org.txt参照）

### 実行例
```
SCRename.py "202304011230_アニメタイトル_テレビ局.ts" "$SCtitle$ 第$SCnumber$話「$SCsubtitle$」($SCservice$)"
```

### 設定ファイル
- SCRename.srv : 放送局名定義ファイル
- SCRename.rp1 : リネーム前置換定義ファイル
- SCRename.rp2 : リネーム後置換定義ファイル
- SCRename.exc : リネーム対象外定義ファイル

**これらのファイルはUTF-8で保存してください。**

## 謝辞
素晴らしいソフトを公開いただいたSCRename.vbsの作者様に心より感謝申し上げます。
